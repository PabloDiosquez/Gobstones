// Comidas Gobianas 游꼴游볧游볫游꼼

type ComidaGobiana is record {
    /*
        PROP칍SITO:
            * Modela una comida que come un gobiano.
        INV. DE REP.:
            * El nombre de la comida no puede estar vac칤o.
            * calor칤as es un n칰mero mayor a cero.
    */

    field nombre   // String
    field origen   // Continente
    field calor칤as // N칰mero
}

type Continente is variant {
    /*
        PROP칍SITO:
            * Modela un continente de donde puede proceder una comida gobiana.
    */

    case 츼frica     {}
    case Am칠rica    {}
    case Asia       {}
    case Europa     {}
    case Ocean칤a    {}
}

// Ejercicio 1)
// Como primer ejercicio queremos modelar dos de las comidas Gobianas m치s t칤picas, las Bolitas de Fraile, y las Bolitas de Queso. Las primeras son una comida originaria de Am칠rica, y tiene 500 calor칤as. La segunda, son de Europa, y tienen tan s칩lo 150 calor칤as. Se pide implementar entonces:
// a. bolitasDeFraile, una funci칩n que describe la comida gobiana Bolitas de Fraile.
// b. bolitasDeQueso, una funci칩n que describe la comida gobiana Bolitas de Queso.

// 1) a.

function bolitasDeFraile() {
    /*
        PROP칍SITO:
            * Describe la comida gobiana Bolitas de Fraile, de Am칠rica con 500 calor칤as.
        TIPO: ComidaGobiana.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (
        ComidaGobiana(
                        nombre   <- "Bolitas de Fraile",
                        origen   <- Am칠rica,
                        calor칤as <- 500
                    )
    )
}

// 1) b.

function bolitasDeQueso() {
    /*
        PROP칍SITO:
            * Describe la comida gobiana Bolitas de Queso, de Europa con 150 calor칤as.
        TIPO: ComidaGobiana.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (
        ComidaGobiana(
                        nombre   <- "Bolitas de Queso",
                        origen   <- Europa,
                        calor칤as <- 150
                    )
    )
}

// Ejercicio 2)
// Deseamos determinar si, dadas dos comidas gobianas, la primera tiene m치s calor칤as que la segunda. Para ello, realizar la funci칩n tieneM치sCalor칤as_Que_ que dadas dos comidas gobianas, indica si la primera tiene m치s calor칤as que la segunda.

function tieneM치sCalor칤as_Que_(primerComida, segundaComida) {
    /*
        PROP칍SITO:
            * Dadas dos comidas gobianas, indica si la primer comida tiene m치s calor칤as que la segunda comida.
        PAR츼METROS:
            * primerComida:  ComidaGobiana.
            * segundaComida: ComidaGobiana.
        TIPO: Booleano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (calor칤as(primerComida) > calor칤as(segundaComida))
}

// Ejercicio 3)
// Adem치s, queremos poder elegir de forma autom치tica la comida m치s saludable, dadas dos comidas gobianas. Para ello, queremos crear lal funci칩n comidaM치sSaludableEntre_Y_ que describe la comida gobiana m치s saludable de las dos comidas dadas. La comida m치s saludable es aquella que tiene menos calor칤as.

function comidaM치sSaludableEntre_Y_(primerComida, segundaComida) {
    /*
        PROP칍SITO:
            * Describe la comida m치s saludable de las dos comidas dadas.
        PAR츼METROS:
            * primerComida:  ComidaGobiana.
            * segundaComida: ComidaGobiana.
        TIPO: ComidaGobiana.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
        OBSERVACIONES:
            * La comida m치s saludable es aquella que tiene menos calor칤as.
    */
    
    return (
            choose primerComida  when (tieneM치sCalor칤as_Que_(segundaComida, primerComida))
                   segundaComida otherwise 
    )
}

// Ejercicio 4)
// Algunos fan치ticos de las comidas gobianas s칩lo comen comidas si provienen de determinadas regiones. Por ello, deseamos poder crear la funci칩n proviene_De_ que dada una comida y un continente indica si una comida proviene del continente dado.

function proviene_De_(comida, origenDeComida) {
    /*
        PROP칍SITO:
            * Indica si **comida** proviene de **continente**.
        PAR츼METROS:
            * comida:         ComidaGobiana.
            * origenDeComida: Continente
        TIPO: Booleano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (origen(comida) == origenDeComida)
}

// Ejercicio 5)
// Hay gente que tiene la idea de que si le unta manteca a la comida, 칠sta se vuelve mucho mejor. Por ese motivo, se quiere hacer la funci칩n enmantecar_ que describe una nueva comida, igual que la dada pero donde las calor칤as aumentan en 200. Por ejemplo, enmantecar una bolita de fraile, produce una bolita de fraile de 700 calor칤as.

function enmantecar_(comidaAEnmantecar) {
    /*
        PROP칍SITO:
            * Describe una nueva comida gobiana, igual que la dada pero con 200 calor칤as m치s.
        PAR츼METROS:
            * comida: ComidaGobiana.
        TIPO: ComidaGobiana.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (ComidaGobiana(comidaAEnmantecar | calor칤as <- calor칤as(comidaAEnmantecar) + 200))
}

// Ejercicio 6)
// Una albondigueada es un tipo de plato que consiste en una serie de alb칩ndigas de carne donde cada una tiene m치s calor칤as que la anterior. Se sirven un total de 5 alb칩ndigas con calor칤as que comienzan en 300 y aumentan de a 100. Se pide que escriba la funci칩n albondigueada que describe una lista de 5 comidas gobianas donde todas las comidas son alb칩ndigas provenientes de Europa, y donde tienen 300, 400, 500, 600 y 700 calor칤as. 

function albondigueada() {
    /*
        PROP칍SITO:
            * Describe una lista de comidas gobianas con alb칩ndigas europeas con diferentes calor칤as, comenzando con 300 y cada una con 100 calor칤as m치s que la anterior.
        TIPO: [ComidaGobiana] (Lista de ComidaGobiana).
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    listaDeAlb칩ndigas := []

    calor칤asDePr칩ximaAlb칩ndiga := 300

    repeat (5) {
        listaDeAlb칩ndigas := listaDeAlb칩ndigas ++ [alb칩ndigaCon_Calor칤as(calor칤asDePr칩ximaAlb칩ndiga)]

        calor칤asDePr칩ximaAlb칩ndiga := calor칤asDePr칩ximaAlb칩ndiga + 100
    }

    return (listaDeAlb칩ndigas)
}

function alb칩ndigaCon_Calor칤as(calor칤as) {
    /*
        PROP칍SITO:
            * Describe una alb칩ndiga europea con **calor칤as** calor칤as.
        PAR츼METROS:
            * calor칤as: N칰mero.
        TIPO: ComidaGobiana.
        PRECONDICIONES:
            * **calor칤as** debe ser >= 0.
    */
    
    return (
        ComidaGobiana(
                    nombre   <- "Alb칩ndiga",
                    origen   <- Europa,
                    calor칤as <- calor칤as
                    )
    )
}

// Ejercicio 7)
// Hay gobianos que s칩lo comen bolitas de fraile. Si les das una pila de comida, primero buscan a ver si hay efectivamente una bolita de fraile, y si hay, se quedan con la pila de comida, sino, la descartan. Por eso, queremos hacer la funci칩n hayUnaBolitaDeFraileEn_ que dada una lista de comidas, indica si en la pila hay alguna cuyo nombre sea "Bolita de Fraile".

function hayUnaBolitaDeFraileEn_(listaDeComidas) {
    /*
        PROP칍SITO:
            * Indica si en la lista de comidas dada hay alguna cuyo nombre sea "Bolita de Fraile".
        PAR츼METROS:
            * listaDeComidas: [ComidaGobiana].
        TIPO: Booleano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
        OBSERVACIONES:
            * Recorrido de b칰squeda sobre listas.
    */
    
    comidasPorMirar := listaDeComidas

    while (not esVac칤a(comidasPorMirar) && 
                nombre(primero(listaDeComidas)) /= "Bolitas de Fraile") {
        
        comidasPorMirar := resto(comidasPorMirar)
    }

    return (not esVac칤a(comidasPorMirar))
}

// Ejercicio 8
// A los gobianos hay que cuidarlos, por eso, cuando se les lleva comida, hay que analizar si no se est치 pasando de la cantidad de calor칤as que un ser humano normal puede consumir. Por eso, queremos hacer la funci칩n cantidadDeCalor칤asDe_ que dada una lista de comidas, describe la cantidad total de calor칤as de los elementos de dicha lista. 

function cantidadDeCalor칤asDe_(listaDeComidas) {
    /*
        PROP칍SITO:
            * Describe la cantidad total de calor칤as de las comidas de la lista de comidas dada.
        PAR츼METROS:
            * listaDeComidas: [ComidaGobiana].
        TIPO: N칰mero.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */

    comidasPorMirar = listaDeComidas

    calor칤asQueYaCont칠 := 0

    while (not esVac칤a(comidasPorMirar)) {
        calor칤asQueYaCont칠 := calor칤asQueYaCont칠 + calor칤as(primero(comidasPorMirar))

        comidasPorMirar := resto(comidasPorMirar)
    }

    return (calor칤asQueYaCont칠)
}

// Ejercicio 9
// Los fan치ticos de la manteca son tan obsesivos que si les das un mont칩n de comida, la enmantecan toda, sin miramientos. Por eso, queremos hacer la funci칩n comidasDe_Enmantecadas que dada una lista de comidas, describe una lista del mismo tama침o que la original, donde cada elemento se corresponde con la comida en dicha lista, pero enmantecada. 

function comidasDe_Enmantecadas(listaDeComidas) {
    /*
        PROP칍SITO:
            * Describe una nueva lista de comidas, del mismo tama침o que la lista de comidas original dada, donde cada elemento se corresponde con la comida en la lista dada, pero enmantecada.
        PAR츼METROS:
            * listaDeComidas: [ComidaGobiana].
        TIPO: [ComidaGobiana].
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    comidasPorMirar := listaDeComidas

    lasComidasEnmantecadasHastaAhora := []

    while (not esVac칤a(comidasPorMirar)) {
        lasComidasEnmantecadasHastaAhora := lasComidasEnmantecadasHastaAhora ++ [enmantecar(primero(comidasPorMirar))]
        
        comidasPorMirar := resto(comidasPorMirar)
    }

    return (lasComidasEnmantecadasHastaAhora)
}

// Ejercicio 10
// Algunos gobianos son muy quisquillosos, y s칩lo comen comidas que verdaderamente los dejen como bolitas a ellos. Por ello, si les das mucha comida, solamente elegir치n comer, aquellas comidas que tengan m치s de 500 calor칤as. Se desea la funci칩n comidasPulentaDe_ que dada una lista de comidas, describe una lista que tiene solamente aquellas comidas de la lista original que tienen m치s de 500 calor칤as.

function comidasPulentaDe_(listaDeComidas) {
    /*
        PROP칍SITO:
            * Describe una lista de comidas gobianas que tiene solamente aquellas comidas de la lista dada que tienen m치s de 500 calor칤as.
        PAR츼METROS:
            * listaDeComidas: [ComidaGobiana].
        TIPO: [ComidaGobiana].
        PRECONDICIONES:
            * No tiene (es una funcipon total).
    */
    
    comidasPorMirar := listaDeComidas

    comidasPulentasVistasAlMomento := []

    while (not esVac칤a(comidasPorMirar)) {
        comidasPulentasVistasAlMomento := comidasPulentasVistasAlMomento
                        ++ singularSi_Vac칤aSino(primero(comidasPorMirar), tiene_M치sDe_Calor칤as(primero(comidasPorMirar), 500))

        comidasPorMirar := resto(comidasPorMirar)
    }

    return (comidasPulentasVistasAlMomento)
}

function tiene_M치sDe_Calor칤as(comidaGobiana, calor칤as) {
    /*
        PROP칍SITO:
            * Indica si la comida dada tiene m치s de 500 calor칤as.
        PAR츼METROS:
            * comidaGobiana: ComidaGobiana.
            * calor칤as:      N칰mero.
        TIPO: Booleano.
        PRECONDICIONES:
            * **calor칤as** debe ser >= 0.
    */
    
    return (calor칤as(comidaGobiana) > calor칤as)
}

// Ejercicio 11 
// En el mundo gobiano tambi칠n hay Chefs, que se han vuelto muy renombrados por sus recetas. Queremos poder modelar a un chef y las recetas de los mismos.

type ChefGobiano is record {
    /*
        PROP칍SITO: 
            * Modela un chef de comida gobiana.
        INV. REP.:
            * **nombre** no debe ser vac칤o.
    */

    field nombre    // String
    field recetas   // [ComidaGobiana] 
}

// Nos interesa saber cosas de un Chef, pero por el momento s칩lo queremos modelar al chef "Sim칩n Bolitas", el gran cocinero que ha dado origen a todo este movimiento. Cree la funci칩n simonBolitas que describe al chef con su repertorio de comidas, que incluyen solamente bolitas de fraile y de queso.

function simonBolitas() {
    /*
        PROP칍SITO: 
            * Describe al chef "Sim칩n Bolitas" con su repertorio de comidas.칄ste incluye, solamente bolitas de fraile y de queso.
        TIPO: ChefGobiano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (
        ChefGobiano(
            nombre  <- "Sim칩n Bolitas",
            recetas <- [bolitasDeFraile(), bolitasDeQueso]
            )
    )
}

// Ejercicio 12
// Para ir cerrando esta secci칩n queremos saber si un chef es demasiado light. Un chef es demasiado light si ninguna de sus comidas es una comida pulenta. Elabore la funci칩n elChefEsMuyLight_ que indique si ninguna de sus comidas es pulenta.


function elChefEsMuyLight_(chefGobiano) {
    /*
        PROP칍SITO:
            * Indica si el chef dado es muy light, esto es, si ninguna de sus comidas es una comida pulenta.
        PAR츼METROS:
            * chefGobiano: ChefGobiano.
        TIPO: Booleano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    // return (esVac칤a(comidasPulentaDe_(recetas(chefGobiano))))

    // RESOLUCI칍N ALTERNATIVA RECORRIENDO LA LISTA DE RECETAS 游뗽

    return(sonLightTodasLasDe_(recetas(chefGobiano)))
}

function sonLightTodasLasDe_(listaDeComidas) {
    /*
        PROP칍SITO:
            * 
        PAR츼METROS:
            * listaDeComidas: [ComidaGobiana]
        TIPO: Booleano.
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
        OBSERVACIONES:
            * Recorrido de b칰squeda sobre la lista de comidas.
    */
    
    comidasPorMirar := listaDeComidas

    while (not esVac칤a(comidasPorMirar) && not esPulenta_(primero(comidasPorMirar))) {
        comidasPorMirar := resto(comidasPorMirar)
    }

    return (esVac칤a(comidasPorMirar))
}

function esPulenta_(comida) {
    /*
        PROP칍SITO:
            * Indica si la comida gobiana dada es pulenta.
        PAR츼METROS:
            * comida: ComidaGobiana.
        TIPO: Booleano.
        PRECONDICIONES:
            * Una comida gobiana es pulenta si tiene m치s de 500 calor칤as.
    */
    
    return (calor칤as(comida) > 500)
}

// FUNCIONES AUXILIARES 游댗

function singularSi_Vac칤aSino(elemento, condici칩n) {
    /*
        PROP칍SITO: 
            * Describe una lista formada 칰nicamente por el elemento dado, si la condici칩n dada es verdadera; caso contrario, describe la lista vac칤a.
        PAR츼METROS:
            * elemento:  Elemento.
            * condici칩n: Booleano.
        TIPO: [Elemento].
        PRECONDICIONES:
            * No tiene (es una funci칩n total).
    */
    
    return (choose [elemento] when (condici칩n)
                   []         otherwise
    )
}